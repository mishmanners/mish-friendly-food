---
import DefaultLayout from "../layouts/Default.astro";

import data from "../../_data/database.json";
import languages from "../../_data/languages.json";
import { Search } from "../components/client/Search.jsx";

function processMultipleFoods(foodItems) {
	return foodItems.map(foodItem => {
		const translations = [];

		Object.keys(data.translations[foodItem]).forEach(translation => {
			const names = data.translations[foodItem][translation];

			translations.push({
				code: translation,
				lang: languages[translation],
				names,
			});
		});

		return {
			name: foodItem,
			translations,
		};
	})
	.sort((a, b) => {
		if (a.name.toLowerCase() < b.name.toLowerCase()) {
			return -1;
		}
		if (a.name.toLowerCase() > b.name.toLowerCase()) {
			return 1;
		}
		return 0;
	});
}

const foods = processMultipleFoods(Object.keys(data.translations));
	.sort((a, b) => {
		if (a.name.toLowerCase() < b.name.toLowerCase()) {
			return -1;
		}
		if (a.name.toLowerCase() > b.name.toLowerCase()) {
			return 1;
		}
		return 0;
	});

const categories = Object.keys(data.categories).map((category) => {
	return {
		name: category,
		foods: data.categories[category],
	};
});

Object.keys(data.dietary_restrictions).forEach((category) => {
	categories.push({
		name: category,
		foods: data.categories[category],
	});
});

categories.sort((a, b) => {
	if (a.name.toLowerCase() < b.name.toLowerCase()) {
		return -1;
	}
	if (a.name.toLowerCase() > b.name.toLowerCase()) {
		return 1;
	}
	return 0;
});
---

<style>
	.foods {
		list-style: none;
		margin: 0;
		padding: 0;

		& li {
			margin: 10px 0;
			padding: 0;
		}

		& summary {
			text-transform: capitalize;
		}
	}

	.categories {
		& a {
			text-transform: capitalize;
		}
	}
</style>

<DefaultLayout>
	<h1>Translations</h1>
	<Search client:load />
	
</DefaultLayout>
